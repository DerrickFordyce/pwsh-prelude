- pipeline: "Prelude Linux Workflow"
  trigger_mode: "ON_EVERY_PUSH"
  ref_name: "master"
  ref_type: "BRANCH"
  priority: "NORMAL"
  fail_on_prepare_env_warning: true
  trigger_condition: "ALWAYS"
  actions:
  - action: "[docker] Lint"
    type: "DOCKERFILE_LINTER"
    local_path: ".devcontainer/Dockerfile"
    shell_type: "bash"
    ignore_codes: "ER0012"
    trigger_condition: "ALWAYS"
  - action: "[pwsh] Lint"
    type: "BUILD"
    working_directory: "/buddy/pwsh-prelude"
    docker_image_name: "microsoft/powershell"
    docker_image_tag: "latest"
    execute_commands:
    - "pwsh -v"
    - "pwsh -File ./Invoke-Setup.ps1"
    - "pwsh -File ./build.ps1 -Lint"
    volume_mappings:
    - "/:/buddy/pwsh-prelude"
    trigger_condition: "ALWAYS"
    shell: "BASH"
  - action: "[dotnet] Test"
    type: "BUILD"
    working_directory: "/buddy/pwsh-prelude"
    docker_image_name: "dotnet/sdk"
    docker_image_tag: "5.0"
    registry: "mcr.microsoft.com"
    execute_commands:
    - "pwsh -File ./Invoke-Setup.ps1"
    - "pwsh -File ./build.ps1 -Test -Skip 'powershell'"
    volume_mappings:
    - "/:/buddy/pwsh-prelude"
    trigger_condition: "ALWAYS"
    shell: "BASH"
  - action: "[pwsh] Test"
    type: "BUILD"
    working_directory: "/buddy/pwsh-prelude"
    docker_image_name: "microsoft/powershell"
    docker_image_tag: "latest"
    execute_commands:
    - "pwsh -Version"
    - "pwsh -File ./Invoke-Setup.ps1"
    - "pwsh -File ./build.ps1 -Test -Tags 'Remote' -Exclude 'WindowsOnly' -Skip 'dotnet'"
    volume_mappings:
    - "/:/buddy/pwsh-prelude"
    trigger_condition: "ALWAYS"
    shell: "BASH"
